<!-- public/pages/dielectric_analysis.html - REESCRITO COM ABAS -->
<div class="container-fluid ps-2 pe-0 d-flex flex-column" style="min-height: calc(100vh - 120px);">    <!-- MODIFICADO: Adicionado ps-2 pe-0 para alinhar com a sidebar. Div onde o painel de informações do transformador será injetado -->
    <div id="transformer-info-dielectric_analysis-page" class="mb-2"></div>
    <!-- Título principal do módulo -->    <div class="card">        <div class="card-header d-flex align-items-center">
            <h6 class="text-center m-0 flex-grow-1 card-header-title">ANÁLISE DIELÉTRICA</h6>
            <button type="button" class="btn btn-sm btn-outline-light ms-2" title="Ajuda sobre Análise Dielétrica">
                <i class="fas fa-question-circle"></i>
            </button>
        </div>
        <div class="card-body">
            <!-- ABAS DE NAVEGAÇÃO INTERNA -->
            <ul class="nav nav-tabs mb-3" id="dielectricTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="basic-analysis-tab" data-bs-toggle="tab" data-bs-target="#basic-analysis-content" type="button" role="tab" aria-controls="basic-analysis-content" aria-selected="true">Dados de Ensaio</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="comprehensive-analysis-tab" data-bs-toggle="tab" data-bs-target="#comprehensive-analysis-content" type="button" role="tab" aria-controls="comprehensive-analysis-content" aria-selected="false">Análise Comparativa</button>
                </li>
            </ul>

            <!-- CONTEÚDO DAS ABAS -->
            <div class="tab-content" id="dielectricTabContent">
                <!-- ABA 1: Dados de Ensaio -->                <div class="tab-pane fade show active" id="basic-analysis-content" role="tabpanel" aria-labelledby="basic-analysis-tab">
                    <form id="dielectric-analysis-form">
                        <div class="row g-2">
                            <!-- Coluna AT -->
                            <div class="col-md-3 pe-1">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <h6 class="text-center m-0" style="font-size: 0.9rem; font-weight: bold; color: var(--text-header);">ALTA TENSÃO</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-2">
                                            <label for="um_at" class="form-label">Tensão Máxima (Um) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="um_at" placeholder="Um AT">
                                        </div>
                                        <div class="mb-2">
                                            <label for="conexao_at_dieletric" class="form-label">Conexão:</label>
                                            <select class="form-select form-select-sm dark-dropdown" id="conexao_at_dieletric">
                                                <option value="estrela_neutro" selected>YN (Estrela Aterrada)</option>
                                                <option value="estrela">Y (Estrela)</option>
                                                <option value="triangulo">D (Triângulo)</option>
                                                <option value="ziguezague_neutro">ZN (Ziguezague Aterrado)</option>
                                                <option value="ziguezague">Z (Ziguezague)</option>
                                            </select>
                                        </div>
                                        <div class="mb-2">
                                            <label for="neutro_um_at" class="form-label">Tensão Máxima Neutro (Um) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="neutro_um_at" placeholder="Um Neutro AT">
                                        </div>
                                        <div class="mb-2">
                                            <label for="ia_at" class="form-label">Impulso Atmosférico (LI/BIL) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="ia_at" placeholder="IA AT">
                                        </div>
                                        <div class="mb-2">
                                            <label for="impulso_atm_neutro_at" class="form-label">Impulso Atmosférico Neutro (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="impulso_atm_neutro_at" placeholder="IA Neutro AT">
                                        </div>
                                        <div class="mb-2">
                                            <label for="im_at" class="form-label">Impulso de Manobra (SI/SIL) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="im_at" placeholder="IM AT">
                                        </div>
                                        <div class="mb-2">
                                            <label for="tensao_curta_at" class="form-label">Tensão Curta Duração (ACLD) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="tensao_curta_at" placeholder="TCD AT">
                                        </div>
                                        <div class="mb-2">
                                            <label for="tensao_induzida_at_dieletric" class="form-label">Tensão Induzida (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="tensao_induzida_at_dieletric" placeholder="TI AT">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Coluna BT -->
                            <div class="col-md-3 px-1">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <h6 class="text-center m-0" style="font-size: 0.9rem; font-weight: bold; color: var(--text-header);">BAIXA TENSÃO</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-2">
                                            <label for="um_bt" class="form-label">Tensão Máxima (Um) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="um_bt" placeholder="Um BT">
                                        </div>
                                        <div class="mb-2">
                                            <label for="conexao_bt_dieletric" class="form-label">Conexão:</label>
                                            <select class="form-select form-select-sm dark-dropdown" id="conexao_bt_dieletric">
                                                <option value="estrela_neutro">YN (Estrela Aterrada)</option>
                                                <option value="estrela">Y (Estrela)</option>
                                                <option value="triangulo" selected>D (Triângulo)</option>
                                                <option value="ziguezague_neutro">ZN (Ziguezague Aterrado)</option>
                                                <option value="ziguezague">Z (Ziguezague)</option>
                                            </select>
                                        </div>
                                        <div class="mb-2">
                                            <label for="neutro_um_bt" class="form-label">Tensão Máxima Neutro (Um) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="neutro_um_bt" placeholder="Um Neutro BT">
                                        </div>
                                        <div class="mb-2">
                                            <label for="ia_bt" class="form-label">Impulso Atmosférico (LI/BIL) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="ia_bt" placeholder="IA BT">
                                        </div>
                                        <div class="mb-2">
                                            <label for="impulso_atm_neutro_bt" class="form-label">Impulso Atmosférico Neutro (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="impulso_atm_neutro_bt" placeholder="IA Neutro BT">
                                        </div>
                                        <div class="mb-2">
                                            <label for="im_bt" class="form-label">Impulso de Manobra (SI/SIL) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="im_bt" placeholder="IM BT">
                                        </div>
                                        <div class="mb-2">
                                            <label for="tensao_curta_bt" class="form-label">Tensão Curta Duração (ACLD) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="tensao_curta_bt" placeholder="TCD BT">
                                        </div>
                                        <div class="mb-2">
                                            <label for="tensao_induzida_bt_dieletric" class="form-label">Tensão Induzida (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="tensao_induzida_bt_dieletric" placeholder="TI BT">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Coluna Terciário -->
                            <div class="col-md-3 px-1">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <h6 class="text-center m-0" style="font-size: 0.9rem; font-weight: bold; color: var(--text-header);">TERCIÁRIO</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-2">
                                            <label for="um_terciario" class="form-label">Tensão Máxima (Um) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="um_terciario" placeholder="Um Terciário">
                                        </div>
                                        <div class="mb-2">
                                            <label for="conexao_terciario_dieletric" class="form-label">Conexão:</label>
                                            <select class="form-select form-select-sm dark-dropdown" id="conexao_terciario_dieletric">
                                                <option value="estrela_neutro">YN (Estrela Aterrada)</option>
                                                <option value="estrela">Y (Estrela)</option>
                                                <option value="triangulo">D (Triângulo)</option>
                                                <option value="ziguezague_neutro">ZN (Ziguezague Aterrado)</option>
                                                <option value="ziguezague">Z (Ziguezague)</option>
                                            </select>
                                        </div>
                                        <div class="mb-2">
                                            <label for="neutro_um_terciario" class="form-label">Tensão Máxima Neutro (Um) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="neutro_um_terciario" placeholder="Um Neutro Terciário">
                                        </div>
                                        <div class="mb-2">
                                            <label for="ia_terciario" class="form-label">Impulso Atmosférico (LI/BIL) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="ia_terciario" placeholder="IA Terciário">
                                        </div>
                                        <div class="mb-2">
                                            <label for="impulso_atm_neutro_terciario" class="form-label">Impulso Atmosférico Neutro (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="impulso_atm_neutro_terciario" placeholder="IA Neutro Terciário">
                                        </div>
                                        <div class="mb-2">
                                            <label for="im_terciario" class="form-label">Impulso de Manobra (SI/SIL) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="im_terciario" placeholder="IM Terciário">
                                        </div>
                                        <div class="mb-2">
                                            <label for="tensao_curta_terciario" class="form-label">Tensão Curta Duração (ACLD) (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="tensao_curta_terciario" placeholder="TCD Terciário">
                                        </div>
                                        <div class="mb-2">
                                            <label for="tensao_induzida_terciario_dieletric" class="form-label">Tensão Induzida (kV):</label>
                                            <input type="number" class="form-control form-control-sm" id="tensao_induzida_terciario_dieletric" placeholder="TI Terciário">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Coluna Direita: Informações Complementares e Resultados -->
                            <div class="col-md-3 ps-1">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <h6 class="m-0" style="font-size: 1rem; font-weight: bold; color: var(--text-header);">Informações e Resultados</h6>
                                    </div>
                                    <div class="card-body d-flex flex-column justify-content-between">
                                        <div>
                                            <h6 class="text-center mb-2" style="font-size: 0.9rem; font-weight: bold; color: var(--primary-color);">Informações Complementares</h6>
                                            <div class="row g-1 mb-1 align-items-center">
                                                <div class="col-6">
                                                    <label class="form-label">Tipo Isolamento:</label>
                                                </div>
                                                <div class="col-6">
                                                    <div id="tipo-isolamento" class="form-control-plaintext text-light" style="font-size: 0.8rem;">-</div>
                                                </div>
                                            </div>
                                            <div class="row g-1 mb-1 align-items-center">
                                                <div class="col-6">
                                                    <label class="form-label">Tipo Trafo:</label>
                                                </div>
                                                <div class="col-6">
                                                    <div id="display-tipo-transformador-dieletric" class="form-control-plaintext text-light" style="font-size: 0.8rem;">-</div>
                                                </div>
                                            </div>
                                            <!-- Campos ocultos para compatibilidade -->
                                            <div style="display: none;">
                                                <div id="display-tensao-aplicada-at-dieletric"></div>
                                                <div id="display-tensao-aplicada-bt-dieletric"></div>
                                                <div id="display-tensao-aplicada-terciario-dieletric"></div>
                                                <input type="hidden" id="tipo_transformador">
                                            </div>
                                            <hr class="my-2">
                                            <div class="row">
                                                <div class="col-12">
                                                    <button type="button" class="btn btn-success mb-2 w-100 btn-sm" id="save-dielectric-params-btn">
                                                        <i class="fas fa-save me-1"></i> Salvar Parâmetros
                                                    </button>
                                                </div>
                                            </div>
                                            <div id="dielectric-save-confirmation" class="text-center" style="min-height: 20px; font-size: 0.75rem;"></div>
                                            <hr class="my-2">
                                            <div class="row">
                                                <div class="col-12">
                                                    <button type="button" class="btn btn-primary mb-2 w-100 btn-sm" id="calc-dielectric-btn">
                                                        <i class="fas fa-calculator me-1"></i> Calcular
                                                    </button>
                                                </div>
                                            </div>
                                            <div id="dielectric-calc-results" class="mt-2" style="min-height: 20px;"></div>
                                            <div id="dielectric-calc-error" class="text-danger text-center mt-2" style="min-height: 20px; font-size: 0.75rem;"></div>
                                            <hr class="my-2">
                                        </div>
                                        <div>
                                            <!-- O botão de "Análise Dielétrica Completa" agora apenas troca de aba -->                            <button type="button" class="btn btn-info mt-2 mb-2 w-100 btn-sm" data-bs-toggle="tab" data-bs-target="#comprehensive-analysis-content" id="analyze-dielectric-detailed-btn">
                                                <i class="fas fa-search-plus me-1"></i> Análise Dielétrica Completa
                                            </button>
                                            <div id="area-informacoes-adicionais"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Container para Alertas -->
                        <div class="row mt-2">
                            <div class="col-12">
                                <div id="alert-container-dieletric"></div>
                            </div>
                        </div>
                    </form>
                </div>
                <!-- FIM DA ABA 1 -->
                <!-- ABA 2: Análise Comparativa (conteúdo original de dielectric_analysis_comprehensive.html) -->
                <div class="tab-pane fade" id="comprehensive-analysis-content" role="tabpanel" aria-labelledby="comprehensive-analysis-tab">
                    <!-- Segunda seção - Parâmetros Selecionados e Título/Descrição lado a lado -->
                    <div class="row mb-2 flex-grow-1 d-flex align-items-stretch">
                        <!-- Coluna 1 (3/4) - Parâmetros Selecionados -->
                        <div class="col-md-9 pe-1">
                            <div class="card h-100" style="box-shadow: 0 3px 5px rgba(0,0,0,0.2);">
                                <div class="card-header" style="background-color: var(--primary-color);">
                                    <h5 class="text-center m-0">Parâmetros Selecionados</h5>
                                </div>
                                <div class="card-body p-3" style="padding: 0.75rem;">
                                    <div id="selected-params-display" class="px-2">
                                        <!-- Conteúdo preenchido por JavaScript -->
                                        <div class="text-muted text-center py-5">Carregando parâmetros...</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Coluna 2 (1/4) - Título e Descrição -->
                        <div class="col-md-3 ps-1">
                            <div class="card h-100" style="box-shadow: 0 3px 5px rgba(0,0,0,0.2);">
                                <div class="card-header" style="background-color: var(--info-color);">
                                    <h5 class="text-center m-0">Análise Dielétrica Completa</h5>
                                </div>
                                <div class="card-body d-flex flex-column justify-content-between" style="height: 100%; padding: 0.75rem;">
                                    <p class="text-center mb-2" style="font-size: 0.8rem;">
                                        Esta ferramenta compara detalhadamente os requisitos das normas NBR/IEC e IEEE para os níveis de isolamento selecionados.
                                    </p>
                                    <div class="text-center mt-auto">
                                        <button type="button" id="analisar-detalhes-button" class="btn btn-primary w-100 mb-2" style="font-size: 0.85rem; padding: 0.5rem 1rem;">
                                            <i class="fas fa-search-plus me-1"></i> Analisar Detalhes
                                        </button>
                                        <button type="button" id="forcar-carregamento-button" class="btn btn-warning w-100 mb-2" style="font-size: 0.85rem; padding: 0.5rem 1rem;">
                                            <i class="fas fa-sync-alt me-1"></i> Forçar Carregamento Dados
                                        </button>
                                        <!-- O botão "Voltar" agora apenas troca de aba -->
                                        <button type="button" class="btn btn-secondary w-100" data-bs-toggle="tab" data-bs-target="#basic-analysis-content" id="switch-to-basic-tab-btn" style="font-size: 0.85rem; padding: 0.5rem 1rem;">
                                            <i class="fas fa-arrow-left me-1"></i> Voltar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quarta seção - Área de Resultados Comparativos (Layout de 3 Colunas) -->
                    <div class="row mb-2 flex-grow-1 d-flex align-items-stretch">
                        <div class="col-md-4 pe-1">
                            <div class="card h-100" style="box-shadow: 0 3px 5px rgba(0,0,0,0.2);">
                                <div class="card-header" style="background-color: var(--primary-color);">
                                    <h5 class="text-center m-0">Análise AT</h5>
                                </div>
                                <div class="card-body p-3" style="padding: 0.75rem; max-height: calc(100vh - 350px); overflow-y: auto;">
                                    <div id="comparison-output-at">
                                        <!-- Conteúdo preenchido por JavaScript -->
                                        <div class="text-muted text-center">Aguardando análise...</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 px-1">
                            <div class="card h-100" style="box-shadow: 0 3px 5px rgba(0,0,0,0.2);">
                                <div class="card-header" style="background-color: var(--secondary-color);">
                                    <h5 class="text-center m-0">Análise BT</h5>
                                </div>
                                <div class="card-body p-3" style="padding: 0.75rem; max-height: calc(100vh - 350px); overflow-y: auto;">
                                    <div id="comparison-output-bt">
                                        <!-- Conteúdo preenchido por JavaScript -->
                                        <div class="text-muted text-center">Aguardando análise...</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 ps-1">
                            <div class="card h-100" style="box-shadow: 0 3px 5px rgba(0,0,0,0.2);">
                                <div class="card-header" style="background-color: var(--info-color);">
                                    <h5 class="text-center m-0">Análise Terciário</h5>
                                </div>
                                <div class="card-body p-3" style="padding: 0.75rem; max-height: calc(100vh - 350px); overflow-y: auto;">
                                    <div id="comparison-output-terciario">
                                        <!-- Conteúdo preenchido por JavaScript -->
                                        <div class="text-muted text-center">Aguardando análise...</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Área de Mensagens/Alertas -->
                    <div id="alert-container-comprehensive" class="fixed-bottom-right-alert">
                        <!-- Alertas dinâmicos serão inseridos aqui -->
                    </div>
                </div>
                <!-- FIM DA ABA 2 -->
            </div>
        </div>
    </div>
</div>